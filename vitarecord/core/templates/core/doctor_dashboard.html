{% extends 'core/base.html' %}
{% block title %}Doctor Dashboard{% endblock %}
{% block content %}
<h2 class='fw-bold mb-4'>
  <i class='bi bi-clipboard2-pulse me-2 text-success'></i>
  Doctor Dashboard
</h2>

<!-- Search Bar -->
<div class='card shadow-sm mb-4'>
  <div class='card-header card-header-blue'>
    <h5 class='mb-0'><i class='bi bi-search me-2'></i>Search Patient by ID</h5>
  </div>
  <div class='card-body'>
    <form method='GET' action='{% url "search_patient" %}'>
      <div class='input-group input-group-lg'>
        <!-- MODULAR: Replace this input with a QR scanner component later -->
        <input type='text' name='patient_id' class='form-control'
               placeholder='Enter Patient Unique ID (e.g. A1B2C3D4)'
               value='{{ request.GET.patient_id }}' required>
        <button class='btn btn-primary' type='submit'>
          <i class='bi bi-search me-1'></i> Search
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Recent Patients -->
<div class='card shadow-sm'>
  <div class='card-header card-header-blue'>
    <h5 class='mb-0'><i class='bi bi-clock-history me-2'></i>Recent Patients</h5>
  </div>
  <div class='card-body p-0'>
    {% if recent_patients %}
    <table class='table table-hover mb-0'>
      <thead class='table-light'>
        <tr><th>Name</th><th>Unique ID</th><th>Last Visit</th><th></th></tr>
      </thead>
      <tbody>
      {% for patient in recent_patients %}
        <tr>
          <td>{{ patient.get_full_name }}</td>
          <td><code>{{ patient.unique_id }}</code></td>
          <td>{{ patient.last_visit|date:'M d, Y' }}</td>
          <td>
            <a href='{% url "consultation" patient.unique_id %}'
               class='btn btn-sm btn-outline-primary'>
              View
            </a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    {% else %}
      <div class='text-center py-4 text-muted'>No recent patients.</div>
    {% endif %}
  </div>
</div>
{% endblock %}
